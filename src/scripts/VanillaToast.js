var ToastType;
(function (ToastType) {
    ToastType["SUCCESS"] = "success";
    ToastType["INFO"] = "info";
    ToastType["WARNING"] = "warning";
    ToastType["ERROR"] = "error";
    ToastType["PLAIN"] = "plain";
    ToastType["CUSTOM"] = "custom";
})(ToastType || (ToastType = {}));
var ToastPosition;
(function (ToastPosition) {
    ToastPosition["TOP_RIGHT"] = "top-right";
    ToastPosition["TOP_LEFT"] = "top-left";
    ToastPosition["BOTTOM_RIGHT"] = "bottom-right";
    ToastPosition["BOTTOM_LEFT"] = "bottom-left";
})(ToastPosition || (ToastPosition = {}));
var VanillaToast = (function () {
    function VanillaToast(parent) {
        this.REMOVE_TIME_MS = 3000;
        this.REMOVE_TIME_MIN_MS = 300;
        this.parent = parent;
    }
    VanillaToast.prototype.showSuccess = function (title, message, position, duration) {
        if (position === void 0) { position = ToastPosition.BOTTOM_LEFT; }
        if (duration === void 0) { duration = this.REMOVE_TIME_MS; }
        var text = this.getCustomToast(title, message, ToastType.SUCCESS);
        var toast = this.addToast(text, position, duration);
        return toast;
    };
    VanillaToast.prototype.showInfo = function (title, message, position, duration) {
        if (position === void 0) { position = ToastPosition.BOTTOM_LEFT; }
        if (duration === void 0) { duration = this.REMOVE_TIME_MS; }
        var text = this.getCustomToast(title, message, ToastType.INFO);
        var toast = this.addToast(text, position, duration);
        return toast;
    };
    VanillaToast.prototype.showWarning = function (title, message, position, duration) {
        if (position === void 0) { position = ToastPosition.BOTTOM_LEFT; }
        if (duration === void 0) { duration = this.REMOVE_TIME_MS; }
        var text = this.getCustomToast(title, message, ToastType.WARNING);
        var toast = this.addToast(text, position, duration);
        return toast;
    };
    VanillaToast.prototype.showError = function (title, message, position, duration) {
        if (position === void 0) { position = ToastPosition.BOTTOM_LEFT; }
        if (duration === void 0) { duration = this.REMOVE_TIME_MS; }
        var text = this.getCustomToast(title, message, ToastType.ERROR);
        var toast = this.addToast(text, position, duration);
        return toast;
    };
    VanillaToast.prototype.showPlain = function (title, message, position, duration) {
        if (position === void 0) { position = ToastPosition.BOTTOM_LEFT; }
        if (duration === void 0) { duration = this.REMOVE_TIME_MS; }
        var text = this.getCustomToast(title, message, ToastType.PLAIN);
        var toast = this.addToast(text, position, duration);
        return toast;
    };
    VanillaToast.prototype.showCustom = function (title, message, iconUrl, position, duration) {
        if (position === void 0) { position = ToastPosition.BOTTOM_LEFT; }
        if (duration === void 0) { duration = this.REMOVE_TIME_MS; }
        var text = this.getCustomToast(title, message, ToastType.CUSTOM, iconUrl);
        var toast = this.addToast(text, position, duration);
        return toast;
    };
    VanillaToast.prototype.getCustomToast = function (title, message, type, iconUrl) {
        if (!title)
            title = " ";
        if (!message)
            message = " ";
        var icon = '<div class="dj-toast-icon"></div>';
        if (type == ToastType.CUSTOM) {
            icon = '<div class="dj-toast-icon" style="background-image: url(' + iconUrl + ');"></div>';
        }
        var toast = document.createElement("div");
        toast.className = "dj-toast dj-toast-" + type;
        toast.style.display = "none";
        toast.insertAdjacentHTML("afterbegin", icon +
            '<div class="dj-toast-text">' +
            '<div class="dj-toast-title">' + title + '</div>' +
            '<div class="dj-toast-message">' + message + '</div></div>');
        toast.fade = function (type, ms, onEnd) {
            var self = toast;
            var isIn = type === 'in', opacity = isIn ? 0 : 1, interval = 10, duration = ms, gap = interval / duration;
            if (isIn) {
                self.style.display = 'block';
                self.style.opacity = opacity;
            }
            function func() {
                opacity = isIn ? opacity + gap : opacity - gap;
                self.style.opacity = opacity;
                if (opacity <= 0)
                    self.style.display = 'none';
                if (opacity <= 0 || opacity >= 1) {
                    window.clearInterval(fading);
                    if (onEnd != null)
                        onEnd();
                }
            }
            var fading = window.setInterval(func, interval);
        };
        toast.fadeIn = function (ms, onEnd) {
            toast.fade("in", ms, onEnd);
        };
        toast.fadeOut = function (ms, onEnd) {
            toast.fade("out", ms, onEnd);
        };
        return toast;
    };
    VanillaToast.prototype.addToast = function (toast, position, duration) {
        if (duration === void 0) { duration = 0; }
        var self = this;
        if (duration <= self.REMOVE_TIME_MIN_MS) {
            duration = self.REMOVE_TIME_MIN_MS;
        }
        var container = this.getContainer(position);
        container.appendChild(toast);
        var closeBtn = document.createElement("div");
        closeBtn.className = "dj-toast-icon-close";
        toast.appendChild(closeBtn);
        closeBtn.addEventListener("pointerdown", function () {
            self.removeToast(toast);
        });
        setTimeout(function () {
            self.removeToast(toast);
        }, duration);
        toast.fadeIn(VanillaToast.FADE_MS);
        return toast;
    };
    VanillaToast.prototype.getContainer = function (position) {
        if (position == ToastPosition.TOP_LEFT && !this.containerTopLeft) {
            this.containerTopLeft = this.createContainer(position);
        }
        else if (position == ToastPosition.TOP_RIGHT && !this.containerTopRight) {
            this.containerTopRight = this.createContainer(position);
        }
        else if (position == ToastPosition.BOTTOM_LEFT && !this.containerBottomLeft) {
            this.containerBottomLeft = this.createContainer(position);
        }
        else if (position == ToastPosition.BOTTOM_RIGHT && !this.containerBottomRight) {
            this.containerBottomRight = this.createContainer(position);
        }
        if (position == ToastPosition.TOP_LEFT) {
            return this.containerTopLeft;
        }
        else if (position == ToastPosition.TOP_RIGHT) {
            return this.containerTopRight;
        }
        else if (position == ToastPosition.BOTTOM_LEFT) {
            return this.containerBottomLeft;
        }
        else if (position == ToastPosition.BOTTOM_RIGHT) {
            return this.containerBottomRight;
        }
        return this.containerBottomLeft;
    };
    VanillaToast.prototype.createContainer = function (position) {
        var container = document.createElement("div");
        container.className = "dj-toast-container-" + position;
        this.parent.appendChild(container);
        return container;
    };
    VanillaToast.prototype.removeToast = function (toast) {
        toast.fadeOut(VanillaToast.FADE_MS, function () {
            toast.remove();
        });
    };
    VanillaToast.FADE_MS = 400;
    return VanillaToast;
}());

//# sourceMappingURL=data:application/json;charset=utf8;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbInNjcmlwdHMvVmFuaWxsYVRvYXN0LnRzIl0sIm5hbWVzIjpbXSwibWFwcGluZ3MiOiJBQUFBLElBQUssU0FPSjtBQVBELFdBQUssU0FBUztJQUNaLGdDQUFtQixDQUFBO0lBQ25CLDBCQUFhLENBQUE7SUFDYixnQ0FBbUIsQ0FBQTtJQUNuQiw0QkFBZSxDQUFBO0lBQ2YsNEJBQWUsQ0FBQTtJQUNmLDhCQUFpQixDQUFBO0FBQ25CLENBQUMsRUFQSSxTQUFTLEtBQVQsU0FBUyxRQU9iO0FBRUQsSUFBSyxhQUtKO0FBTEQsV0FBSyxhQUFhO0lBQ2hCLHdDQUF1QixDQUFBO0lBQ3ZCLHNDQUFxQixDQUFBO0lBQ3JCLDhDQUE2QixDQUFBO0lBQzdCLDRDQUEyQixDQUFBO0FBQzdCLENBQUMsRUFMSSxhQUFhLEtBQWIsYUFBYSxRQUtqQjtBQUVEO0lBWUUsc0JBQVksTUFBVztRQVRmLG1CQUFjLEdBQUcsSUFBSSxDQUFDO1FBQ3RCLHVCQUFrQixHQUFHLEdBQUcsQ0FBQztRQVMvQixJQUFJLENBQUMsTUFBTSxHQUFHLE1BQU0sQ0FBQztJQUN2QixDQUFDO0lBRU0sa0NBQVcsR0FBbEIsVUFBbUIsS0FBYSxFQUFFLE9BQWUsRUFBRSxRQUFtRCxFQUFFLFFBQThCO1FBQW5GLHlCQUFBLEVBQUEsV0FBMEIsYUFBYSxDQUFDLFdBQVc7UUFBRSx5QkFBQSxFQUFBLFdBQVcsSUFBSSxDQUFDLGNBQWM7UUFDcEksSUFBSSxJQUFJLEdBQWdCLElBQUksQ0FBQyxjQUFjLENBQUMsS0FBSyxFQUFFLE9BQU8sRUFBRSxTQUFTLENBQUMsT0FBTyxDQUFDLENBQUM7UUFDL0UsSUFBSSxLQUFLLEdBQWdCLElBQUksQ0FBQyxRQUFRLENBQUMsSUFBSSxFQUFFLFFBQVEsRUFBRSxRQUFRLENBQUMsQ0FBQztRQUNqRSxNQUFNLENBQUMsS0FBSyxDQUFDO0lBQ2YsQ0FBQztJQUVNLCtCQUFRLEdBQWYsVUFBZ0IsS0FBYSxFQUFFLE9BQWUsRUFBRSxRQUFtRCxFQUFFLFFBQThCO1FBQW5G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UUFDN0MsSUFBSSxTQUFTLEdBQUcsUUFBUSxDQUFDLGFBQWEsQ0FBQyxLQUFLLENBQUMsQ0FBQztRQUM5QyxTQUFTLENBQUMsU0FBUyxHQUFHLHFCQUFxQixHQUFHLFFBQVEsQ0FBQztRQUN2RCxJQUFJLENBQUMsTUFBTSxDQUFDLFdBQVcsQ0FBQyxTQUFTLENBQUMsQ0FBQztRQUNuQyxNQUFNLENBQUMsU0FBUyxDQUFDO0lBQ25CLENBQUM7SUFFTyxrQ0FBVyxHQUFuQixVQUFvQixLQUFVO1FBRTVCLEtBQUssQ0FBQyxPQUFPLENBQUMsWUFBWSxDQUFDLE9BQU8sRUFBRTtZQUNoQyxLQUFLLENBQUMsTUFBTSxFQUFFLENBQUM7UUFDakIsQ0FBQyxDQUNGLENBQUM7SUFDSixDQUFDO0lBaExjLG9CQUFPLEdBQUcsR0FBRyxDQUFDO0lBaUwvQixtQkFBQztDQW5MRCxBQW1MQyxJQUFBIiwiZmlsZSI6InNjcmlwdHMvVmFuaWxsYVRvYXN0LmpzIiwic291cmNlc0NvbnRlbnQiOlsiZW51bSBUb2FzdFR5cGUge1xuICBTVUNDRVNTID0gXCJzdWNjZXNzXCIsXG4gIElORk8gPSBcImluZm9cIixcbiAgV0FSTklORyA9IFwid2FybmluZ1wiLFxuICBFUlJPUiA9IFwiZXJyb3JcIixcbiAgUExBSU4gPSBcInBsYWluXCIsXG4gIENVU1RPTSA9IFwiY3VzdG9tXCJcbn1cblxuZW51bSBUb2FzdFBvc2l0aW9uIHtcbiAgVE9QX1JJR0hUID0gXCJ0b3AtcmlnaHRcIixcbiAgVE9QX0xFRlQgPSBcInRvcC1sZWZ0XCIsXG4gIEJPVFRPTV9SSUdIVCA9IFwiYm90dG9tLXJpZ2h0XCIsXG4gIEJPVFRPTV9MRUZUID0gXCJib3R0b20tbGVmdFwiXG59XG5cbmNsYXNzIFZhbmlsbGFUb2FzdCB7XG5cbiAgcHJpdmF0ZSBzdGF0aWMgRkFERV9NUyA9IDQwMDtcbiAgcHJpdmF0ZSBSRU1PVkVfVElNRV9NUyA9IDMwMDA7XG4gIHByaXZhdGUgUkVNT1ZFX1RJTUVfTUlOX01TID0gMzAwO1xuXG4gIHByaXZhdGUgcGFyZW50OiBhbnk7XG4gIHByaXZhdGUgY29udGFpbmVyVG9wTGVmdDogYW55O1xuICBwcml2YXRlIGNvbnRhaW5lclRvcFJpZ2h0OiBhbnk7XG4gIHByaXZhdGUgY29udGFpbmVyQm90dG9tTGVmdDogYW55O1xuICBwcml2YXRlIGNvbnRhaW5lckJvdHRvbVJpZ2h0OiBhbnk7XG5cbiAgY29uc3RydWN0b3IocGFyZW50OiBhbnkpIHtcbiAgICB0aGlzLnBhcmVudCA9IHBhcmVudDtcbiAgfVxuXG4gIHB1YmxpYyBzaG93U3VjY2Vzcyh0aXRsZTogc3RyaW5nLCBtZXNzYWdlOiBzdHJpbmcsIHBvc2l0aW9uOiBUb2FzdFBvc2l0aW9uID0gVG9hc3RQb3NpdGlvbi5CT1RUT01fTEVGVCwgZHVyYXRpb24gPSB0aGlzLlJFTU9WRV9USU1FX01TKTogSFRNTEVsZW1lbnQge1xuICAgIGxldCB0ZXh0OiBIVE1MRWxlbWVudCA9IHRoaXMuZ2V0Q3VzdG9tVG9hc3QodGl0bGUsIG1lc3NhZ2UsIFRvYXN0VHlwZS5TVUNDRVNTKTtcbiAgICBsZXQgdG9hc3Q6IEhUTUxFbGVtZW50ID0gdGhpcy5hZGRUb2FzdCh0ZXh0LCBwb3NpdGlvbiwgZHVyYXRpb24pO1xuICAgIHJldHVybiB0b2FzdDtcbiAgfVxuXG4gIHB1YmxpYyBzaG93SW5mbyh0aXRsZTogc3RyaW5nLCBtZXNzYWdlOiBzdHJpbmcsIHBvc2l0aW9uOiBUb2FzdFBvc2l0aW9uID0gVG9hc3RQb3NpdGlvbi5CT1RUT01fTEVGVCwgZHVyYXRpb24gPSB0aGlzLlJFTU9WRV9USU1FX01TKTogSFRNTEVsZW1lbnQge1xuICAgIGxldCB0ZXh0OiBIVE1MRWxlbWVudCA9IHRoaXMuZ2V0Q3VzdG9tVG9hc3QodGl0bGUsIG1lc3NhZ2UsIFRvYXN0VHlwZS5JTkZPKTtcbiAgICBsZXQgdG9hc3Q6IEhUTUxFbGVtZW50ID0gdGhpcy5hZGRUb2FzdCh0ZXh0LCBwb3NpdGlvbiwgZHVyYXRpb24pO1xuICAgIHJldHVybiB0b2FzdDtcbiAgfVxuXG4gIHB1YmxpYyBzaG93V2FybmluZyh0aXRsZTogc3RyaW5nLCBtZXNzYWdlOiBzdHJpbmcsIHBvc2l0aW9uOiBUb2FzdFBvc2l0aW9uID0gVG9hc3RQb3NpdGlvbi5CT1RUT01fTEVGVCwgZHVyYXRpb24gPSB0aGlzLlJFTU9WRV9USU1FX01TKTogSFRNTEVsZW1lbnQge1xuICAgIGxldCB0ZXh0OiBIVE1MRWxlbWVudCA9IHRoaXMuZ2V0Q3VzdG9tVG9hc3QodGl0bGUsIG1lc3NhZ2UsIFRvYXN0VHlwZS5XQVJOSU5HKTtcbiAgICBsZXQgdG9hc3Q6IEhUTUxFbGVtZW50ID0gdGhpcy5hZGRUb2FzdCh0ZXh0LCBwb3NpdGlvbiwgZHVyYXRpb24pO1xuICAgIHJldHVybiB0b2FzdDtcbiAgfVxuXG4gIHB1YmxpYyBzaG93RXJyb3IodGl0bGU6IHN0cmluZywgbWVzc2FnZTogc3RyaW5nLCBwb3NpdGlvbjogVG9hc3RQb3NpdGlvbiA9IFRvYXN0UG9zaXRpb24uQk9UVE9NX0xFRlQsIGR1cmF0aW9uID0gdGhpcy5SRU1PVkVfVElNRV9NUyk6IEhUTUxFbGVtZW50IHtcbiAgICBsZXQgdGV4dDogSFRNTEVsZW1lbnQgPSB0aGlzLmdldEN1c3RvbVRvYXN0KHRpdGxlLCBtZXNzYWdlLCBUb2FzdFR5cGUuRVJST1IpO1xuICAgIGxldCB0b2FzdDogSFRNTEVsZW1lbnQgPSB0aGlzLmFkZFRvYXN0KHRleHQsIHBvc2l0aW9uLCBkdXJhdGlvbik7XG4gICAgcmV0dXJuIHRvYXN0O1xuICB9XG5cbiAgcHVibGljIHNob3dQbGFpbih0aXRsZTogc3RyaW5nLCBtZXNzYWdlOiBzdHJpbmcsIHBvc2l0aW9uOiBUb2FzdFBvc2l0aW9uID0gVG9hc3RQb3NpdGlvbi5CT1RUT01fTEVGVCwgZHVyYXRpb24gPSB0aGlzLlJFTU9WRV9USU1FX01TKTogSFRNTEVsZW1lbnQge1xuICAgIGxldCB0ZXh0OiBIVE1MRWxlbWVudCA9IHRoaXMuZ2V0Q3VzdG9tVG9hc3QodGl0bGUsIG1lc3NhZ2UsIFRvYXN0VHlwZS5QTEFJTik7XG4gICAgbGV0IHRvYXN0OiBIVE1MRWxlbWVudCA9IHRoaXMuYWRkVG9hc3QodGV4dCwgcG9zaXRpb24sIGR1cmF0aW9uKTtcbiAgICByZXR1cm4gdG9hc3Q7XG4gIH1cblxuICBwdWJsaWMgc2hvd0N1c3RvbSh0aXRsZTogc3RyaW5nLCBtZXNzYWdlOiBzdHJpbmcsIGljb25Vcmw6IHN0cmluZywgcG9zaXRpb246IFRvYXN0UG9zaXRpb24gPSBUb2FzdFBvc2l0aW9uLkJPVFRPTV9MRUZULCBkdXJhdGlvbiA9IHRoaXMuUkVNT1ZFX1RJTUVfTVMpOiBIVE1MRWxlbWVudCB7XG4gICAgbGV0IHRleHQ6IEhUTUxFbGVtZW50ID0gdGhpcy5nZXRDdXN0b21Ub2FzdCh0aXRsZSwgbWVzc2FnZSwgVG9hc3RUeXBlLkNVU1RPTSwgaWNvblVybCk7XG4gICAgbGV0IHRvYXN0OiBIVE1MRWxlbWVudCA9IHRoaXMuYWRkVG9hc3QodGV4dCwgcG9zaXRpb24sIGR1cmF0aW9uKTtcbiAgICByZXR1cm4gdG9hc3Q7XG4gIH1cblxuICBwcml2YXRlIGdldEN1c3RvbVRvYXN0KHRpdGxlOiBzdHJpbmcsIG1lc3NhZ2U6IHN0cmluZywgdHlwZTogVG9hc3RUeXBlLCBpY29uVXJsPzogc3RyaW5nKTogSFRNTEVsZW1lbnQge1xuXG4gICAgaWYgKCF0aXRsZSkgdGl0bGUgPSBcIiBcIjtcbiAgICBpZiAoIW1lc3NhZ2UpIG1lc3NhZ2UgPSBcIiBcIjtcblxuICAgIGxldCBpY29uID0gJzxkaXYgY2xhc3M9XCJkai10b2FzdC1pY29uXCI+PC9kaXY+JztcbiAgICBpZiAodHlwZSA9PSBUb2FzdFR5cGUuQ1VTVE9NKSB7XG4gICAgICBpY29uID0gJzxkaXYgY2xhc3M9XCJkai10b2FzdC1pY29uXCIgc3R5bGU9XCJiYWNrZ3JvdW5kLWltYWdlOiB1cmwoJyArIGljb25VcmwgKyAnKTtcIj48L2Rpdj4nO1xuICAgIH1cblxuICAgIGxldCB0b2FzdDogYW55ID0gZG9jdW1lbnQuY3JlYXRlRWxlbWVudChcImRpdlwiKTtcbiAgICB0b2FzdC5jbGFzc05hbWUgPSBcImRqLXRvYXN0IGRqLXRvYXN0LVwiICsgdHlwZTtcbiAgICB0b2FzdC5zdHlsZS5kaXNwbGF5ID0gXCJub25lXCI7XG4gICAgdG9hc3QuaW5zZXJ0QWRqYWNlbnRIVE1MKFwiYWZ0ZXJiZWdpblwiLFxuICAgICAgaWNvbiArXG4gICAgICAnPGRpdiBjbGFzcz1cImRqLXRvYXN0LXRleHRcIj4nICtcbiAgICAgICc8ZGl2IGNsYXNzPVwiZGotdG9hc3QtdGl0bGVcIj4nICsgdGl0bGUgKyAnPC9kaXY+JyArXG4gICAgICAnPGRpdiBjbGFzcz1cImRqLXRvYXN0LW1lc3NhZ2VcIj4nICsgbWVzc2FnZSArICc8L2Rpdj48L2Rpdj4nXG4gICAgKTtcblxuICAgIHRvYXN0LmZhZGUgPSAodHlwZTogc3RyaW5nLCBtczogbnVtYmVyLCBvbkVuZD86ICgpID0+IHZvaWQpID0+IHtcbiAgICAgIGxldCBzZWxmOiBhbnkgPSB0b2FzdDtcblxuICAgICAgbGV0IGlzSW4gPSB0eXBlID09PSAnaW4nLFxuICAgICAgICBvcGFjaXR5ID0gaXNJbiA/IDAgOiAxLFxuICAgICAgICBpbnRlcnZhbCA9IDEwLFxuICAgICAgICBkdXJhdGlvbiA9IG1zLFxuICAgICAgICBnYXAgPSBpbnRlcnZhbCAvIGR1cmF0aW9uO1xuXG4gICAgICBpZiAoaXNJbikge1xuICAgICAgICBzZWxmLnN0eWxlLmRpc3BsYXkgPSAnYmxvY2snO1xuICAgICAgICBzZWxmLnN0eWxlLm9wYWNpdHkgPSBvcGFjaXR5O1xuICAgICAgfVxuXG4gICAgICBmdW5jdGlvbiBmdW5jKCkge1xuICAgICAgICBvcGFjaXR5ID0gaXNJbiA/IG9wYWNpdHkgKyBnYXAgOiBvcGFjaXR5IC0gZ2FwO1xuICAgICAgICBzZWxmLnN0eWxlLm9wYWNpdHkgPSBvcGFjaXR5O1xuXG4gICAgICAgIGlmIChvcGFjaXR5IDw9IDApIHNlbGYuc3R5bGUuZGlzcGxheSA9ICdub25lJ1xuICAgICAgICBpZiAob3BhY2l0eSA8PSAwIHx8IG9wYWNpdHkgPj0gMSkge1xuICAgICAgICAgIHdpbmRvdy5jbGVhckludGVydmFsKGZhZGluZyk7XG4gICAgICAgICAgaWYgKG9uRW5kICE9IG51bGwpIG9uRW5kKCk7XG4gICAgICAgIH1cbiAgICAgIH1cblxuICAgICAgbGV0IGZhZGluZyA9IHdpbmRvdy5zZXRJbnRlcnZhbChmdW5jLCBpbnRlcnZhbCk7XG4gICAgfTtcblxuICAgIHRvYXN0LmZhZGVJbiA9IChtczogbnVtYmVyLCBvbkVuZD86ICgpID0+IHZvaWQpID0+IHtcbiAgICAgIHRvYXN0LmZhZGUoXCJpblwiLCBtcywgb25FbmQpO1xuICAgIH07XG5cbiAgICB0b2FzdC5mYWRlT3V0ID0gKG1zOiBudW1iZXIsIG9uRW5kPzogKCkgPT4gdm9pZCkgPT4ge1xuICAgICAgdG9hc3QuZmFkZShcIm91dFwiLCBtcywgb25FbmQpO1xuICAgIH07XG5cbiAgICByZXR1cm4gdG9hc3Q7XG4gIH1cblxuICBwcml2YXRlIGFkZFRvYXN0KHRvYXN0OiBhbnksIHBvc2l0aW9uOiBUb2FzdFBvc2l0aW9uLCBkdXJhdGlvbjogbnVtYmVyID0gMCk6IEhUTUxFbGVtZW50IHtcblxuICAgIGxldCBzZWxmID0gdGhpcztcblxuICAgIGlmIChkdXJhdGlvbiA8PSBzZWxmLlJFTU9WRV9USU1FX01JTl9NUykge1xuICAgICAgZHVyYXRpb24gPSBzZWxmLlJFTU9WRV9USU1FX01JTl9NUztcbiAgICB9XG5cbiAgICBsZXQgY29udGFpbmVyOiBhbnkgPSB0aGlzLmdldENvbnRhaW5lcihwb3NpdGlvbik7XG4gICAgY29udGFpbmVyLmFwcGVuZENoaWxkKHRvYXN0KTtcblxuICAgIC8vIEFkZCBjbG9zZSBidXR0b25cbiAgICBsZXQgY2xvc2VCdG46IEhUTUxFbGVtZW50ID0gZG9jdW1lbnQuY3JlYXRlRWxlbWVudChcImRpdlwiKTtcbiAgICBjbG9zZUJ0bi5jbGFzc05hbWUgPSBcImRqLXRvYXN0LWljb24tY2xvc2VcIjtcbiAgICB0b2FzdC5hcHBlbmRDaGlsZChjbG9zZUJ0bik7XG5cbiAgICBjbG9zZUJ0bi5hZGRFdmVudExpc3RlbmVyKFwicG9pbnRlcmRvd25cIiwgZnVuY3Rpb24gKCkge1xuICAgICAgc2VsZi5yZW1vdmVUb2FzdCh0b2FzdCk7XG4gICAgfSk7XG5cbiAgICBzZXRUaW1lb3V0KGZ1bmN0aW9uICgpIHtcbiAgICAgIHNlbGYucmVtb3ZlVG9hc3QodG9hc3QpXG4gICAgfSwgZHVyYXRpb24pO1xuXG4gICAgdG9hc3QuZmFkZUluKFZhbmlsbGFUb2FzdC5GQURFX01TKTtcblxuICAgIHJldHVybiB0b2FzdDtcbiAgfVxuXG4gIHByaXZhdGUgZ2V0Q29udGFpbmVyKHBvc2l0aW9uOiBUb2FzdFBvc2l0aW9uKTogYW55IHtcblxuICAgIGlmIChwb3NpdGlvbiA9PSBUb2FzdFBvc2l0aW9uLlRPUF9MRUZUICYmICF0aGlzLmNvbnRhaW5lclRvcExlZnQpIHtcbiAgICAgIHRoaXMuY29udGFpbmVyVG9wTGVmdCA9IHRoaXMuY3JlYXRlQ29udGFpbmVyKHBvc2l0aW9uKTtcbiAgICB9IGVsc2UgaWYgKHBvc2l0aW9uID09IFRvYXN0UG9zaXRpb24uVE9QX1JJR0hUICYmICF0aGlzLmNvbnRhaW5lclRvcFJpZ2h0KSB7XG4gICAgICB0aGlzLmNvbnRhaW5lclRvcFJpZ2h0ID0gdGhpcy5jcmVhdGVDb250YWluZXIocG9zaXRpb24pO1xuICAgIH0gZWxzZSBpZiAocG9zaXRpb24gPT0gVG9hc3RQb3NpdGlvbi5CT1RUT01fTEVGVCAmJiAhdGhpcy5jb250YWluZXJCb3R0b21MZWZ0KSB7XG4gICAgICB0aGlzLmNvbnRhaW5lckJvdHRvbUxlZnQgPSB0aGlzLmNyZWF0ZUNvbnRhaW5lcihwb3NpdGlvbik7XG4gICAgfSBlbHNlIGlmIChwb3NpdGlvbiA9PSBUb2FzdFBvc2l0aW9uLkJPVFRPTV9SSUdIVCAmJiAhdGhpcy5jb250YWluZXJCb3R0b21SaWdodCkge1xuICAgICAgdGhpcy5jb250YWluZXJCb3R0b21SaWdodCA9IHRoaXMuY3JlYXRlQ29udGFpbmVyKHBvc2l0aW9uKTtcbiAgICB9XG5cbiAgICBpZiAocG9zaXRpb24gPT0gVG9hc3RQb3NpdGlvbi5UT1BfTEVGVCkge1xuICAgICAgcmV0dXJuIHRoaXMuY29udGFpbmVyVG9wTGVmdDtcbiAgICB9IGVsc2UgaWYgKHBvc2l0aW9uID09IFRvYXN0UG9zaXRpb24uVE9QX1JJR0hUKSB7XG4gICAgICByZXR1cm4gdGhpcy5jb250YWluZXJUb3BSaWdodDtcbiAgICB9IGVsc2UgaWYgKHBvc2l0aW9uID09IFRvYXN0UG9zaXRpb24uQk9UVE9NX0xFRlQpIHtcbiAgICAgIHJldHVybiB0aGlzLmNvbnRhaW5lckJvdHRvbUxlZnQ7XG4gICAgfSBlbHNlIGlmIChwb3NpdGlvbiA9PSBUb2FzdFBvc2l0aW9uLkJPVFRPTV9SSUdIVCkge1xuICAgICAgcmV0dXJuIHRoaXMuY29udGFpbmVyQm90dG9tUmlnaHQ7XG4gICAgfVxuXG4gICAgcmV0dXJuIHRoaXMuY29udGFpbmVyQm90dG9tTGVmdDtcbiAgfVxuXG4gIHByaXZhdGUgY3JlYXRlQ29udGFpbmVyKHBvc2l0aW9uOiBUb2FzdFBvc2l0aW9uKTogYW55IHtcbiAgICBsZXQgY29udGFpbmVyID0gZG9jdW1lbnQuY3JlYXRlRWxlbWVudChcImRpdlwiKTtcbiAgICBjb250YWluZXIuY2xhc3NOYW1lID0gXCJkai10b2FzdC1jb250YWluZXItXCIgKyBwb3NpdGlvbjtcbiAgICB0aGlzLnBhcmVudC5hcHBlbmRDaGlsZChjb250YWluZXIpO1xuICAgIHJldHVybiBjb250YWluZXI7XG4gIH1cblxuICBwcml2YXRlIHJlbW92ZVRvYXN0KHRvYXN0OiBhbnkpIHtcblxuICAgIHRvYXN0LmZhZGVPdXQoVmFuaWxsYVRvYXN0LkZBREVfTVMsIGZ1bmN0aW9uICgpIHtcbiAgICAgICAgdG9hc3QucmVtb3ZlKCk7XG4gICAgICB9XG4gICAgKTtcbiAgfVxufVxuIl19
